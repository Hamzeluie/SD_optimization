schema: '2.0'
stages:
  train:
    cmd: python src/train.py params.yaml
    deps:
    - path: data
      hash: md5
      md5: d78d75e69d0b7ff8150401ec6ef2bc81.dir
      size: 3009647873
      nfiles: 8804
    - path: src/train.py
      hash: md5
      md5: 8be1bda062ff021fb0897689fdb832c2
      size: 7087
    params:
      params.yaml:
        train.adam_beta1: 0.09
        train.adam_beta2: 0.999
        train.adam_epsilon: 1e-08
        train.adam_weight_decay: 0.01
        train.checkpointing_steps: 5000
        train.dataset_name: head
        train.eval_index: IS_score_mean
        train.eval_index_max: true
        train.eval_path: /home/naserwin/hamze/SD_optimization/results/eval
        train.instance_data_dir: /home/naserwin/hamze/SD_optimization/data/screw
        train.instance_prompt: '#screw@head@defect#'
        train.learning_rate: 5e-06
        train.lr_num_cycles: 1
        train.lr_power: 1.0
        train.lr_warmup_steps: 500
        train.max_grad_norm: 1.0
        train.max_train_steps: 40000
        train.num_train_epochs: 1
        train.pretrained_model_name_or_path: runwayml/stable-diffusion-v1-5
        train.resolution: 512
        train.sample_batch_size: 1
        train.train_batch_size: 1
        train.trained_model_path: /home/naserwin/hamze/SD_optimization/results
        train.with_prior_preservation: false
    outs:
    - path: results/trained_model
      hash: md5
      md5: 2f21e96f399e4f861612ba257a68f64e.dir
      size: 10968719085
      nfiles: 33
  convert:
    cmd: python src/convert_ckpt.py params.yaml
    deps:
    - path: results/trained_model
      hash: md5
      md5: 2f21e96f399e4f861612ba257a68f64e.dir
      size: 10968719085
      nfiles: 33
    - path: src/convert_ckpt.py
      hash: md5
      md5: 4823203266aab2ef341db38a3e760bd5
      size: 1434
    params:
      params.yaml:
        convert.checkpoint_path: /home/naserwin/hamze/SD_optimization/results/checkpoints
        convert.trained_model_path: /home/naserwin/hamze/SD_optimization/results/trained_model
    outs:
    - path: results/checkpoints
      hash: md5
      md5: 2d29f60044029d6be57ea82851360995.dir
      size: 8530708914
      nfiles: 2
